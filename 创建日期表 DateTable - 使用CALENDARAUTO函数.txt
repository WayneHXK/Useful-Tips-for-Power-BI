DIM DateTable = 
    GENERATE(
    CALENDARAUTO(9),     // 财年的最后一个月，比如9月
    VAR CurrentDay = [Date]
    VAR DateKey = FORMAT([Date], "YYYYMMDD")
    VAR Year = YEAR(CurrentDay)
    VAR Quarter = "Q" & QUARTER(CurrentDay)        // 比如Q1
    VAR MonthNum = MONTH(CurrentDay)               // 1位月份数字
    VAR MonthNum2Digit = FORMAT(CurrentDay, "MM")  // 2位月份数字
    VAR MonthAbbr = FORMAT(CurrentDay, "MMM")      // 3位月份英文缩写
    VAR MonthFullName = FORMAT(CurrentDay, "MMMM") // 英文月份全称
    VAR Day = DAY(CurrentDay)                      // 数字几号
    VAR WeekId = WEEKDAY(CurrentDay, 1)            // 数字周几
    VAR WeekdayName = FORMAT(CurrentDay, "dddd")   // 英文周几全称
    VAR WeekdayAbbr = FORMAT(CurrentDay, "ddd")    // 英文周几缩写
    VAR WeekNum = WEEKNUM(CurrentDay, 1)           // 第几周
    VAR FiscalYearNum = IF(MonthNum < 10, Year, Year + 1) // 财年数字
    VAR FiscalYear = "FY" & FiscalYearNum          // 财年带FY
    VAR FiscalQuarterNum = IF(QUARTER(CurrentDay) = 4, 1, QUARTER(CurrentDay) + 1)
    VAR FiscalQuarter = "Q" & FiscalQuarterNum     // 财季
    VAR FiscalMonthNum = IF(MonthNum >= 10, MonthNum - 9, MonthNum + 3)  // 财年的第几个月
   
    RETURN ROW(
        "DateKey", DateKey,
        "Year", Year,
        "Quarter", Quarter,
        "MonthNum", MonthNum2Digit,        // 2位月份数字
        "MonthAbbr", MonthAbbr,            // 3位月份英文缩写
        "MonthName", MonthFullName,        // 英文月份全称
        "Day", Day,
        "WeekID", WeekId,                  // 数字周几
        "WeekdayName", WeekdayName,        // 英文周几全称
        "WeekdayAbbr", WeekdayAbbr,        // 英文周几缩写
        "WeekNum", WeekNum,                // 第几周
        "YearMonthSort", Year & MonthNum2Digit,  // 比如202501
        "Year-Month", Year & "-" & MonthAbbr,    // 比如2025-Jan
        "Year-Quarter", Year & "-" & Quarter,    // 比如2025-Q1
        "FiscalYear", FiscalYear,          // FY2025
        "FiscalMonthNum", FiscalMonthNum,  // 比如2025年12月，对应数字3
        "FiscalYearMonthSort", FiscalYearNum & FORMAT(FiscalMonthNum, "00"), // 比如202504，对应2025年1月份
        "FiscalYear-Month", FiscalYear & "-" & MonthAbbr,  // 比如 FY2025-Feb (修正了拼写错误)
        "FiscalQuarter", FiscalQuarter,    // 财季 Q1
        "FiscalQuarterSort", FiscalYearNum & FORMAT(FiscalQuarterNum, "00"), // 比如202501
        "FiscalYear-Quarter", FiscalYear & "-" & FiscalQuarter    // 财年财季 FY2025-Q1
    )
)
